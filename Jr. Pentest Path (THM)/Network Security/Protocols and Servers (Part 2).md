  
This notes sheet covers how protocols can be upgraded or replaced to protect against disclosure, alteration, and destruction (DAD triad) attacks.

### Sniffing Attack

- Using a network packet capture tool to collect information about a target

Examples of tools used to capture network packet:

1. **Tcpdump** ->  is a free open source command-line interface (CLI) program that has been ported to work on many operating systems.

2. **Wireshark**  -> is a free open source graphical user interface (GUI) program available for several operating systems, including Linux, macOS and MS Windows.

3. **Tshark**  -> is a CLI alternative to Wireshark.


#### Command Line Examples

- The output below shows how pop3 traffic can be read using the `tcpdump` command

`pentester@TryHackMe$ sudo tcpdump port 110 -A`
`[...] 09:05:15.132861 IP 10.20.30.1.58386 > 10.20.30.148.pop3: Flags [P.], seq 1:13, ack 19, win 502, options [nop,nop,TS val 423360697 ecr 3958275530], length 12 E..@.V@.@.g.`
`...` 
`......n......"............`
`.;....}.USER frank` 
`09:05:15.133465 IP 10.20.30.148.pop3 > 10.20.30.1.58386: Flags [.], ack 13, win 510, options [nop,nop,TS val 3958280553 ecr 423360697], length 0` 
`E..4..@.@.O~` 
`... ....n....".........?P..... ...i.;.. 09:05:15.133610 IP 10.20.30.148.pop3 > 10.20.30.1.58386: Flags [P.], seq 19:43, ack 13, win 510, options [nop,nop,TS val 3958280553 ecr 423360697], length 24 E..L..@.@.Oe` 
`... ....n....".........<-.....` 
`...i.;..+OK Password required.` 
`09:05:15.133660 IP 10.20.30.1.58386 > 10.20.30.148.pop3: Flags [.], ack 43, win 502, options [nop,nop,TS val 423360698 ecr 3958280553], length 0` 
`E..4.W@.@.g.` 
`... ......n......".....??..... .;.....i` 
`09:05:22.852695 IP 10.20.30.1.58386 > 10.20.30.148.pop3: Flags [P.], seq 13:28, ack 43, win 502, options [nop,nop,TS val 423368417 ecr 3958280553], length 15` 
`E..C.X@.@.g.` 
`... ......n......".....6...... .`
`<.....iPASS D2xc9CgD [...]`


### Man in the Middle Attack (MITM)

- Occurs when a victim (A) believes they are communicating with a legitimate second user (B), but is actually communicating with an attack (E)

Tools for MIM Attacks:

1) Ettercap
2) Bettercap

### Transport Layer Security

  - TLS protects, among other things, against password sniffing and MITM attacks

Example Communication Channel using SSL/TLS
1. Client sends a ClientHello to the server to indicate its capabilities, such as supported algorithms.
2. The server responds with a ServerHello, indicating the selected connection parameters. The server provides its certificate if server authentication is required. The certificate is a digital file to identify itself; it is usually digitally signed by a third party. Moreover, it might send additional information necessary to generate the master key, in its ServerKeyExchange message, before sending the ServerHelloDone message to indicate that it is done with the negotiation.
3. The client responds with a ClientKeyExchange, which contains additional information required to generate the master key. Furthermore, it switches to use encryption and informs the server using the ChangeCipherSpec message.
4. The server switches to use encryption as well and informs the client in the ChangeCipherSpec message.

### Secure Shell (SSH)

- Created to provide a secure way for remote system administration

To use SSH:
- A username and password is required
- A private and public key (after SSH server is configured to recognize the corresponding public key)
- Port 22 is the default

Ex. Connecting to an SSH server

	ssh username@MACHINE_IP


- Use Secure Copy Protocol (scp) to transfer files while using SCP 


### Password Attack 

Attacks against passwords are usually carried out by:

1. Password Guessing: Guessing a password requires some knowledge of the target, such as their pet’s name 
2. Dictionary Attack: This approach expands on password guessing and attempts to include all valid words in a dictionary or a wordlist.
3. Brute Force Attack: This attack is where an attacker can go as far as trying all possible character combinations, which grows fast (exponential growth with the number of characters).

#### Hydra

Command Flags:

	-l -> login name of the target
	-P -> precedes the wordlist file, which is a file containint a list of passwords 
	- s -> specify a non-default port
	- V -> verbose output
	- t n -> n is the number of parallel conections to the target
	- d -> debugging mode


	Ex. hydra -l mark -P /usr/share/wordlist/rockyou.txt 10.10.10.10 ftp

